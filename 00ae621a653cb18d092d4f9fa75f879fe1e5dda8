{
  "comments": [
    {
      "key": {
        "uuid": "fafc7978_e0c5ea3c",
        "filename": "vpnservice/natservice/natservice-impl/src/main/java/org/opendaylight/netvirt/natservice/internal/ExternalRoutersListener.java",
        "patchSetId": 1
      },
      "lineNbr": 2380,
      "author": {
        "id": 5802
      },
      "writtenOn": "2017-02-13T13:54:17Z",
      "side": 1,
      "message": "I think you need to delete this method and call buildNaptPfibFlowEntity instead due to scenario mentioned in this thread https://lists.opendaylight.org/pipermail/netvirt-dev/2016-December/002599.html\n\nwe need the NXM_OF_IN_PORT reset before resubmit to fib also for cases of vlan/flat provider networks\n\nAlso, the router-gw-ip match makes no difference in this case since all traffic with the external net/subnet vpn-id will be resubmitted to the FIB so no point creating different matches in the NAPT_PFIB table",
      "revId": "00ae621a653cb18d092d4f9fa75f879fe1e5dda8",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_db789bf4",
        "filename": "vpnservice/natservice/natservice-impl/src/main/java/org/opendaylight/netvirt/natservice/internal/ExternalRoutersListener.java",
        "patchSetId": 1
      },
      "lineNbr": 2380,
      "author": {
        "id": 6248
      },
      "writtenOn": "2017-02-13T15:02:43Z",
      "side": 1,
      "message": "It does not build the same flow.\nThe flow we currently build in buildNaptFibExternalOutputFlowEntity include the IP address in the match.\n\nI either change buildNaptPfibFlowEntity and use it.\nOr add to buildNaptFibExternalOutputFlowEntity action to reset the NXM_OF_IN_PORT\nWhat is best?",
      "parentUuid": "fafc7978_e0c5ea3c",
      "revId": "00ae621a653cb18d092d4f9fa75f879fe1e5dda8",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_9b03b341",
        "filename": "vpnservice/natservice/natservice-impl/src/main/java/org/opendaylight/netvirt/natservice/internal/ExternalRoutersListener.java",
        "patchSetId": 1
      },
      "lineNbr": 2380,
      "author": {
        "id": 5802
      },
      "writtenOn": "2017-02-13T15:10:52Z",
      "side": 1,
      "message": "I know it\u0027s not building the same flow. if you goto group it has some meaning since the group is associated to subnet and the subnet is determined by the subnet-id of the router-gw ip.\nAfter the hairpinning pipeline changes, the subnet id will be set in the medatadata of outbound NAPT(46) so there is no point to create flow per ip since all flows are resubmitting back to the FIB. It\u0027s better to reuse the exiting code from buildNaptPfibFlowEntity",
      "parentUuid": "fafc7978_db789bf4",
      "revId": "00ae621a653cb18d092d4f9fa75f879fe1e5dda8",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_2600a766",
        "filename": "vpnservice/natservice/natservice-impl/src/main/java/org/opendaylight/netvirt/natservice/internal/ExternalRoutersListener.java",
        "patchSetId": 1
      },
      "lineNbr": 2380,
      "author": {
        "id": 6248
      },
      "writtenOn": "2017-02-14T09:22:09Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fafc7978_e0c5ea3c",
      "revId": "00ae621a653cb18d092d4f9fa75f879fe1e5dda8",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_c608bb93",
        "filename": "vpnservice/natservice/natservice-impl/src/main/java/org/opendaylight/netvirt/natservice/internal/ExternalRoutersListener.java",
        "patchSetId": 1
      },
      "lineNbr": 2380,
      "author": {
        "id": 6248
      },
      "writtenOn": "2017-02-14T09:22:09Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fafc7978_9b03b341",
      "revId": "00ae621a653cb18d092d4f9fa75f879fe1e5dda8",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    }
  ]
}