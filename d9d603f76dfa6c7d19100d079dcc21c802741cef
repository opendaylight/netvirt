{
  "comments": [
    {
      "key": {
        "uuid": "da2a55be_821d4769",
        "filename": "vpnservice/natservice/natservice-impl/src/main/java/org/opendaylight/netvirt/natservice/internal/NaptManager.java",
        "patchSetId": 1
      },
      "lineNbr": 328,
      "author": {
        "id": 5867
      },
      "writtenOn": "2017-07-07T13:02:05Z",
      "side": 1,
      "message": "why this new ArrayList\u003c\u003e(), which will copy?   Now that you\u0027ve changed it to be sure that it\u0027s a @NonNull List, this seems a wasted object allocation (not that it matters much, but just for fun) - or am I missing something here I could learn?  Just remove this, no?",
      "revId": "d9d603f76dfa6c7d19100d079dcc21c802741cef",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da2a55be_22e45b0c",
        "filename": "vpnservice/natservice/natservice-impl/src/main/java/org/opendaylight/netvirt/natservice/internal/NaptManager.java",
        "patchSetId": 1
      },
      "lineNbr": 328,
      "author": {
        "id": 4540
      },
      "writtenOn": "2017-07-07T13:54:02Z",
      "side": 1,
      "message": "In general, this is just defensive coding — we immediately add to portList (line 331), so I want to be absolutely sure I have a modifiable list to do so. It’s also nice because if the code I’m calling isn’t itself defensive, I avoid modifying its internal structures.\n\nIn *this particular case*, I also know that getInternalIpPortListInfo() is liable to return the result of Collections.emptyList(), which isn’t modifiable (so the add() would fail).\n\nNote that in the grand scheme of things, we should really settle on whether callers need to be defensive, or callees. It’s one of the things I still find lacking in Java collections: you can’t easily indicate whether the collection you’re returning is modifiable or not.",
      "parentUuid": "da2a55be_821d4769",
      "revId": "d9d603f76dfa6c7d19100d079dcc21c802741cef",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da2a55be_02acb79f",
        "filename": "vpnservice/natservice/natservice-impl/src/main/java/org/opendaylight/netvirt/natservice/internal/NaptManager.java",
        "patchSetId": 1
      },
      "lineNbr": 328,
      "author": {
        "id": 5867
      },
      "writtenOn": "2017-07-07T14:02:36Z",
      "side": 1,
      "message": "Ah yeah; I didn\u0027t pay attention to the add() in the following line... ;-) nice catch!  Re. \"ndicate whether the collection you’re returning is modifiable or not\", I guess we could start pushing for using the Guava unmodifiable collection interfaces more, see https://github.com/google/guava/wiki/ImmutableCollectionsExplained ...",
      "parentUuid": "da2a55be_22e45b0c",
      "revId": "d9d603f76dfa6c7d19100d079dcc21c802741cef",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da2a55be_a2c16be6",
        "filename": "vpnservice/natservice/natservice-impl/src/main/java/org/opendaylight/netvirt/natservice/internal/NaptManager.java",
        "patchSetId": 1
      },
      "lineNbr": 328,
      "author": {
        "id": 4540
      },
      "writtenOn": "2017-07-07T14:44:27Z",
      "side": 1,
      "message": "Yes, we could explicitly state that any method returning non-modifiable collections must return a Guava immutable collection, and anything else can be assumed to be modifiable (safely, i.e. without affecting the callee). That would also give us Guava’s early null rejection which would allow us to delete a lot of null checks...",
      "parentUuid": "da2a55be_02acb79f",
      "revId": "d9d603f76dfa6c7d19100d079dcc21c802741cef",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    }
  ]
}