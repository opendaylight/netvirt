{
  "comments": [
    {
      "key": {
        "uuid": "9a245df4_f27963fd",
        "filename": "vpnservice/vpnmanager/vpnmanager-api/src/main/yang/odl-l3vpn.yang",
        "patchSetId": 34
      },
      "lineNbr": 264,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:21:17Z",
      "side": 1,
      "message": "configured",
      "range": {
        "startLine": 264,
        "startChar": 21,
        "endLine": 264,
        "endChar": 35
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_128997eb",
        "filename": "vpnservice/vpnmanager/vpnmanager-api/src/main/yang/odl-l3vpn.yang",
        "patchSetId": 34
      },
      "lineNbr": 267,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:21:17Z",
      "side": 1,
      "message": "handles IPv4 traffic",
      "range": {
        "startLine": 267,
        "startChar": 36,
        "endLine": 267,
        "endChar": 49
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_d27edfe3",
        "filename": "vpnservice/vpnmanager/vpnmanager-api/src/main/yang/odl-l3vpn.yang",
        "patchSetId": 34
      },
      "lineNbr": 270,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:21:17Z",
      "side": 1,
      "message": "configured",
      "range": {
        "startLine": 270,
        "startChar": 21,
        "endLine": 270,
        "endChar": 35
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_b277eb01",
        "filename": "vpnservice/vpnmanager/vpnmanager-api/src/main/yang/odl-l3vpn.yang",
        "patchSetId": 34
      },
      "lineNbr": 273,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:21:17Z",
      "side": 1,
      "message": "handles IPv6 traffic",
      "range": {
        "startLine": 273,
        "startChar": 36,
        "endLine": 273,
        "endChar": 49
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_725e1347",
        "filename": "vpnservice/vpnmanager/vpnmanager-impl/src/main/java/org/opendaylight/netvirt/vpnmanager/SubnetmapChangeListener.java",
        "patchSetId": 34
      },
      "lineNbr": 10,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:21:17Z",
      "side": 1,
      "message": "I just realised the updating the VpnInstance in SubnetMapChangeListener can cause very bad effects on a bgpvpn delete scenario.:(\nOn a bgpvpn-delete, the dissociate and vpn-delete happen at the same time. This might lead to the update getting committed later than the delete, causing stale vpn-op-data entry to exist in the datastore.\n\nSo, please move the part of updateVpnWithIpFamily out of SubnetMapCHangeListener. Call them in the NeutronBgpvpnChangeListener update() method. you wont have to call it again in the remove() method as the vpn-op-data delete anyways will withdraw the configured vrfs from the vpn",
      "range": {
        "startLine": 10,
        "startChar": 0,
        "endLine": 10,
        "endChar": 0
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_32d2dbd2",
        "filename": "vpnservice/vpnmanager/vpnmanager-impl/src/main/java/org/opendaylight/netvirt/vpnmanager/SubnetmapChangeListener.java",
        "patchSetId": 34
      },
      "lineNbr": 92,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:21:17Z",
      "side": 1,
      "message": "Move this method to NeutronVpnUtils, and in the getIpVersion method, convert all the ifs to if...else and place them in a single try-catch block.",
      "range": {
        "startLine": 92,
        "startChar": 57,
        "endLine": 92,
        "endChar": 69
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_32e93b81",
        "filename": "vpnservice/vpnmanager/vpnmanager-impl/src/main/java/org/opendaylight/netvirt/vpnmanager/SubnetmapChangeListener.java",
        "patchSetId": 34
      },
      "lineNbr": 93,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:21:17Z",
      "side": 1,
      "message": "See comments on line138.",
      "range": {
        "startLine": 93,
        "startChar": 17,
        "endLine": 93,
        "endChar": 95
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_6d13d65c",
        "filename": "vpnservice/vpnmanager/vpnmanager-impl/src/main/java/org/opendaylight/netvirt/vpnmanager/SubnetmapChangeListener.java",
        "patchSetId": 34
      },
      "lineNbr": 169,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:44:01Z",
      "side": 1,
      "message": "Move this code block to a utility method in NeutronVpnUtils, and call it in NeutronBgpvpnChangeListener, as mentioned in my earlier comment.",
      "range": {
        "startLine": 149,
        "startChar": 12,
        "endLine": 169,
        "endChar": 13
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_4d10924e",
        "filename": "vpnservice/vpnmanager/vpnmanager-impl/src/main/java/org/opendaylight/netvirt/vpnmanager/SubnetmapChangeListener.java",
        "patchSetId": 34
      },
      "lineNbr": 196,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:44:01Z",
      "side": 1,
      "message": "Move this code block to a utility method in NeutronVpnUtils, and call it in NeutronBgpvpnChangeListener, as mentioned in my earlier comment.",
      "range": {
        "startLine": 175,
        "startChar": 12,
        "endLine": 196,
        "endChar": 13
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_6d68f6ba",
        "filename": "vpnservice/vpnmanager/vpnmanager-impl/src/main/java/org/opendaylight/netvirt/vpnmanager/VpnInstanceListener.java",
        "patchSetId": 34
      },
      "lineNbr": 135,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:44:01Z",
      "side": 1,
      "message": "Please go through my comments in VpnUtil.java.\n\nNone of the changes in this file will be necessary if my comments in VpnUtil.java hold good.",
      "range": {
        "startLine": 135,
        "startChar": 0,
        "endLine": 135,
        "endChar": 0
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_9290e7ed",
        "filename": "vpnservice/vpnmanager/vpnmanager-impl/src/main/java/org/opendaylight/netvirt/vpnmanager/VpnInstanceListener.java",
        "patchSetId": 34
      },
      "lineNbr": 259,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:21:17Z",
      "side": 1,
      "message": "change this to false",
      "range": {
        "startLine": 259,
        "startChar": 44,
        "endLine": 259,
        "endChar": 48
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_72b0d38b",
        "filename": "vpnservice/vpnmanager/vpnmanager-impl/src/main/java/org/opendaylight/netvirt/vpnmanager/VpnInstanceListener.java",
        "patchSetId": 34
      },
      "lineNbr": 263,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:21:17Z",
      "side": 1,
      "message": "else not needed. Always create your own operTxn here and merge.",
      "range": {
        "startLine": 260,
        "startChar": 10,
        "endLine": 263,
        "endChar": 9
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_cd792295",
        "filename": "vpnservice/vpnmanager/vpnmanager-impl/src/main/java/org/opendaylight/netvirt/vpnmanager/VpnInstanceListener.java",
        "patchSetId": 34
      },
      "lineNbr": 429,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:44:01Z",
      "side": 1,
      "message": "There are two ways to approach addVrf() call to BGP:\n\n1) The existing approach where we blindly call addVrf() on a vpn instance addition. If you want to follow this, then we dont need to track which subnets are added to the vpn, since addVrf() for v4 and v6 will be handled purely based on the addition/deletion of that vpn.\n\n2) This is the new approach that you have currently coded in this review. Here you are advertising/withdrawing vrf for a vpn strictly based on the presence/absence of a v4/v6 subnet in that vpn. In this case the above changes are not required, since the addVrf() for v4/v6 is handled purely based on an update to vpn-instance-op-data.\n\nSince you have already coded to conform to option (2) above, lets continue with that.\nIn this case, changes in line 420-429 are not required.",
      "range": {
        "startLine": 420,
        "startChar": 13,
        "endLine": 429,
        "endChar": 13
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_cd876260",
        "filename": "vpnservice/vpnmanager/vpnmanager-impl/src/main/java/org/opendaylight/netvirt/vpnmanager/VpnOpStatusListener.java",
        "patchSetId": 34
      },
      "lineNbr": 80,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:44:01Z",
      "side": 1,
      "message": "else-if(update.getVpnState() \u003d\u003d VpnState.Created) {\n// add/delete Vrf accordingly\n}",
      "range": {
        "startLine": 79,
        "startChar": 8,
        "endLine": 80,
        "endChar": 71
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_2d21de9f",
        "filename": "vpnservice/vpnmanager/vpnmanager-impl/src/main/java/org/opendaylight/netvirt/vpnmanager/VpnUtil.java",
        "patchSetId": 34
      },
      "lineNbr": 1814,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:44:01Z",
      "side": 1,
      "message": "This wont be needed if my comments in line 1814 holds good.",
      "range": {
        "startLine": 1790,
        "startChar": 4,
        "endLine": 1814,
        "endChar": 5
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_ad1dce68",
        "filename": "vpnservice/vpnmanager/vpnmanager-impl/src/main/java/org/opendaylight/netvirt/vpnmanager/VpnUtil.java",
        "patchSetId": 34
      },
      "lineNbr": 1864,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:44:01Z",
      "side": 1,
      "message": "Instead of updating the vpn-instance config DS, update the boolean values directly in vpn-instance-op-data here.\nAnd then, do a tx.merge() with false as the last parameter here.",
      "range": {
        "startLine": 1817,
        "startChar": 7,
        "endLine": 1864,
        "endChar": 100
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a245df4_8d1a8a6c",
        "filename": "vpnservice/vpnmanager/vpnmanager-impl/src/main/java/org/opendaylight/netvirt/vpnmanager/VpnUtil.java",
        "patchSetId": 34
      },
      "lineNbr": 1905,
      "author": {
        "id": 5871
      },
      "writtenOn": "2017-10-18T15:44:01Z",
      "side": 1,
      "message": "same comment as in line 1817",
      "range": {
        "startLine": 1870,
        "startChar": 9,
        "endLine": 1905,
        "endChar": 104
      },
      "revId": "e10109de98ed92b08c40224f3165d3bc2caa82a9",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    }
  ]
}