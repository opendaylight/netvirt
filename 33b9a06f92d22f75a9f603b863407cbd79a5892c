{
  "comments": [
    {
      "key": {
        "uuid": "fafc7978_819ca85e",
        "filename": "vpnservice/aclservice/impl/pom.xml",
        "patchSetId": 6
      },
      "lineNbr": 59,
      "author": {
        "id": 773
      },
      "writtenOn": "2017-02-26T16:14:15Z",
      "side": 1,
      "message": "try not to include the impl if possible. I think this is the issue you are facing with aclservice not coming up. ElanUtils takes IInterfaceManager in it\u0027s blueprint and in all modules in  netvirt, except aclservice, we use the previous method of explicitly including all dependencies in the blueprint.xml. aclservice uses the new way with the simpler blueprint.xml files that uses injection using the autowire.xml files. When that is used it expects the service refs to be named after the interface very explictly. In this case IInterfaceManager is the interface so autowaire.xml expects to see iInterfaceManager. But notice in the elan blueprint.xml the reference id is interfaceManager, so aclservice-impl fails to come up because it doesn\u0027t see the right naming.\n\nSo I think if you can remove the need to use the impl - which I think it best - then you would avoid this dependency. You could also try to change the name in the elan blueprint.xml to be iInterfaceManager and see if that helps. The naming in the elan side doesn\u0027t matter to elan since we pass the id via the blueprint.xml and as long as the constructor args match type wise it is happy.\n\nOr maybe add the reference id to the aclservice blueprint.xml with the right naming like below, this should be an easy test also:\n\n\u003creference id\u003d\"iInterfaceManager\"\n    interface\u003d\"org.opendaylight.genius.interfacemanager.interfaces.IInterfaceManager\" /\u003e",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_e1a494a7",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/AbstractIngressAclServiceImpl.java",
        "patchSetId": 6
      },
      "lineNbr": 89,
      "author": {
        "id": 773
      },
      "writtenOn": "2017-02-26T16:14:15Z",
      "side": 1,
      "message": "would it be better to have this util in mdsalutil/MetaDataUtil?",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_870f9887",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/AbstractIngressAclServiceImpl.java",
        "patchSetId": 6
      },
      "lineNbr": 89,
      "author": {
        "id": 670
      },
      "writtenOn": "2017-02-27T13:49:07Z",
      "side": 1,
      "message": "good idea, moved into MetaDataUtil and lost the ElanUtil dependency",
      "parentUuid": "fafc7978_e1a494a7",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_674f146c",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/StatefulIngressAclServiceImpl.java",
        "patchSetId": 6
      },
      "lineNbr": 131,
      "author": {
        "id": 6238
      },
      "writtenOn": "2017-02-27T09:38:18Z",
      "side": 1,
      "message": "1. Why do you use learn table in stateful acl code?\n2. Shouldn\u0027t this rule remain on the EGRESS_ACL_FILTER_TABLE?",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_38324df2",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/StatefulIngressAclServiceImpl.java",
        "patchSetId": 6
      },
      "lineNbr": 131,
      "author": {
        "id": 670
      },
      "writtenOn": "2017-02-27T13:49:07Z",
      "side": 1,
      "message": "1. Mistake, corrected thanks.\n2. No it should nowbe EGRESS_ACL_REMOTE_ACL_TABLE (which will goto EGRESS_ACL_FILTER_TABLE)",
      "parentUuid": "fafc7978_674f146c",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_e5001904",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/StatefulIngressAclServiceImpl.java",
        "patchSetId": 6
      },
      "lineNbr": 131,
      "author": {
        "id": 6238
      },
      "writtenOn": "2017-02-28T06:36:28Z",
      "side": 1,
      "message": "2. As I understand the EGRESS_ACL_REMOTE_ACL_TABLE should only add acl_id metadata for any ip+elan_id. The conntrack and all the implementation logic should remain in EGRESS_ACL_FILTER_TABLE.",
      "parentUuid": "fafc7978_38324df2",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_9e387ed4",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/StatefulIngressAclServiceImpl.java",
        "patchSetId": 6
      },
      "lineNbr": 131,
      "author": {
        "id": 670
      },
      "writtenOn": "2017-02-28T11:38:38Z",
      "side": 1,
      "message": "Yes, this line only configures ACL1 (ACL_FILTER_TABLE) to goto the new ACL2 (ACL_REMOTE_ACL_TABLE), instead of going directly to ACL3.\n\nthe conntrack logic will stay in ACL1 and ACL3 (previously ACL2) as before.",
      "parentUuid": "fafc7978_e5001904",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_875af827",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/listeners/AclNodeListener.java",
        "patchSetId": 6
      },
      "lineNbr": 167,
      "author": {
        "id": 6238
      },
      "writtenOn": "2017-02-27T09:38:18Z",
      "side": 1,
      "message": "All the methods \"add...AclRemoteAclTableMissFlow\" you added are very similar except for the table constants, please consider merge this to one method.",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_784fb56b",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/listeners/AclNodeListener.java",
        "patchSetId": 6
      },
      "lineNbr": 167,
      "author": {
        "id": 670
      },
      "writtenOn": "2017-02-27T13:49:07Z",
      "side": 1,
      "message": "Yeah, it\u0027s only duplicated for Learn now because of the different tables.. All the other implementations use a common function.",
      "parentUuid": "fafc7978_875af827",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_67c9d425",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/listeners/AclNodeListener.java",
        "patchSetId": 6
      },
      "lineNbr": 342,
      "author": {
        "id": 6238
      },
      "writtenOn": "2017-02-27T09:38:18Z",
      "side": 1,
      "message": "Don\u0027t we need to install default flows for remote acl table in transparent case?\nOr maybe it is better to not implement anything concerning remote acls for transparent impl (not changing this function)?\nIf you do want to implement the passing through acl remote table, it should be done for ingress side as well in the previous function.",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_585471fe",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/listeners/AclNodeListener.java",
        "patchSetId": 6
      },
      "lineNbr": 342,
      "author": {
        "id": 670
      },
      "writtenOn": "2017-02-27T13:49:07Z",
      "side": 1,
      "message": "I think the transparent ACL doesn\u0027t even bind anymore, I just corrected this for completeness, it\u0027s basically dead code..",
      "parentUuid": "fafc7978_67c9d425",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_c7524066",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/listeners/AclNodeListener.java",
        "patchSetId": 6
      },
      "lineNbr": 345,
      "author": {
        "id": 6238
      },
      "writtenOn": "2017-02-27T09:38:18Z",
      "side": 1,
      "message": "please don\u0027t use learn table for transparent acl impl",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_985a5928",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/listeners/AclNodeListener.java",
        "patchSetId": 6
      },
      "lineNbr": 345,
      "author": {
        "id": 670
      },
      "writtenOn": "2017-02-27T13:49:07Z",
      "side": 1,
      "message": "correct, thanks, wasn\u0027t intentional just some sed issues",
      "parentUuid": "fafc7978_c7524066",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_4767704d",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/listeners/AclNodeListener.java",
        "patchSetId": 6
      },
      "lineNbr": 359,
      "author": {
        "id": 6238
      },
      "writtenOn": "2017-02-27T09:38:18Z",
      "side": 1,
      "message": "I think there is bug here. The rule should be installed on EGRESS_ACL_TABLE and not on EGRESS_ACL_FILTER_TABLE.\nSame bug in previous function.\nAm I wrong?",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_f869e5be",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/listeners/AclNodeListener.java",
        "patchSetId": 6
      },
      "lineNbr": 359,
      "author": {
        "id": 670
      },
      "writtenOn": "2017-02-27T13:49:07Z",
      "side": 1,
      "message": "I think it\u0027s ok, I added the remote ACL default flow now, I think that confused you.\nIn any case need to check with Shlomi - since transparent doesn\u0027t bind at all anymore, this code could probably be removed.",
      "parentUuid": "fafc7978_4767704d",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_6762743f",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/listeners/AclNodeListener.java",
        "patchSetId": 6
      },
      "lineNbr": 396,
      "author": {
        "id": 6238
      },
      "writtenOn": "2017-02-27T09:38:18Z",
      "side": 1,
      "message": "This code is for stateless, why do you use learn table consts?",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fafc7978_d866a1ec",
        "filename": "vpnservice/aclservice/impl/src/main/java/org/opendaylight/netvirt/aclservice/listeners/AclNodeListener.java",
        "patchSetId": 6
      },
      "lineNbr": 396,
      "author": {
        "id": 670
      },
      "writtenOn": "2017-02-27T13:49:07Z",
      "side": 1,
      "message": "mistake",
      "parentUuid": "fafc7978_6762743f",
      "revId": "33b9a06f92d22f75a9f603b863407cbd79a5892c",
      "serverId": "7fc14799-209e-464c-9743-7a06c2c21a81",
      "unresolved": false
    }
  ]
}